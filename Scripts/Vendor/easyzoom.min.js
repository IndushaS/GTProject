/*! @preserve
 * @name        EasyZoom
 * @author      Matt Hinchliffe <>
 * @modified    Monday, April 18th, 2016
 * @version     2.4.0
 */
!function($){"use strict";function t(t,e){this.$target=$(t),this.opts=$.extend({},a,e,this.$target.data()),void 0===this.isOpen&&this._init()}var e,i,o,s,h,n,a={loadingNotice:"",errorNotice:"",errorDuration:2500,linkAttribute:"data-zoom",preventClicks:!1,beforeShow:$.noop,beforeHide:$.noop,onShow:$.noop,onHide:$.noop,onMove:$.noop};t.prototype._init=function(){this.$link=this.$target.find(".easyzoom-container"),this.$image=this.$target.find("img"),this.$flyout=$('<div class="easyzoom-flyout" />'),this.$notice=$('<div class="easyzoom-notice" />'),this.$target.on({"mousemove.easyzoom touchmove.easyzoom":$.proxy(this._onMove,this),"mouseleave.easyzoom touchend.easyzoom":$.proxy(this._onLeave,this),"mouseenter.easyzoom touchstart.easyzoom":$.proxy(this._onEnter,this)})},t.prototype.show=function(t,h){var n,a,r,d,c=this;if(this.opts.beforeShow.call(this)!==!1){if(!this.isReady)return this._loadImage(this.$link.attr(this.opts.linkAttribute),function(){!c.isMouseOver&&h||c.show(t)});$(window).width()>768&&this.$target.append(this.$flyout),n=this.$target.width(),a=this.$target.height(),r=this.$flyout.width(),d=this.$flyout.height(),e=this.$zoom.width()-r,i=this.$zoom.height()-d,0>e&&(e=0),0>i&&(i=0),o=e/n,s=i/a,this.isOpen=!0,this.opts.onShow.call(this),t&&this._move(t)}},t.prototype._onEnter=function(t){var e=t.originalEvent.touches;this.isMouseOver=!0,e&&1!=e.length||this.show(t,!0)},t.prototype._onMove=function(t){this.isOpen&&this._move(t)},t.prototype._onLeave=function(){this.isMouseOver=!1,this.isOpen&&this.hide()},t.prototype._onLoad=function(t){t.currentTarget.width&&(this.isReady=!0,this.$notice.detach(),this.$flyout.html(this.$zoom),this.$target.removeClass("is-loading").addClass("is-ready"),t.data.call&&t.data())},t.prototype._onError=function(){var t=this;this.$notice.text(this.opts.errorNotice),this.$target.removeClass("is-loading").addClass("is-error"),this.detachNotice=setTimeout(function(){t.$notice.detach(),t.detachNotice=null},this.opts.errorDuration)},t.prototype._loadImage=function(t,e){var i=new Image;this.$target.addClass("is-loading").append(this.$notice.text(this.opts.loadingNotice)),this.$zoom=$(i).on("error",$.proxy(this._onError,this)).on("load",e,$.proxy(this._onLoad,this)),i.style.position="absolute",i.src=t},t.prototype._move=function(t){if(0===t.type.indexOf("touch")){var a=t.touches||t.originalEvent.touches;h=a[0].pageX,n=a[0].pageY}else h=t.pageX||h,n=t.pageY||n;var r=this.$target.offset(),d=n-r.top,c=h-r.left,l=Math.ceil(d*s),p=Math.ceil(c*o);if(0>p||0>l||p>e||l>i)this.hide();else{var u=-1*l,f=-1*p;this.$zoom.css({top:u,left:f}),this.opts.onMove.call(this,u,f)}},t.prototype.hide=function(){this.isOpen&&this.opts.beforeHide.call(this)!==!1&&(this.$flyout.detach(),this.isOpen=!1,this.opts.onHide.call(this))},t.prototype.swap=function(t,e,i){this.hide(),this.isReady=!1,this.detachNotice&&clearTimeout(this.detachNotice),this.$notice.parent().length&&this.$notice.detach(),this.$target.removeClass("is-loading is-ready is-error"),this.$image.attr({src:t,srcset:$.isArray(i)?i.join():i}),this.$link.attr(this.opts.linkAttribute,e)},t.prototype.teardown=function(){this.hide(),this.$target.off(".easyzoom").removeClass("is-loading is-ready is-error"),this.detachNotice&&clearTimeout(this.detachNotice),delete this.$link,delete this.$zoom,delete this.$image,delete this.$notice,delete this.$flyout,delete this.isOpen,delete this.isReady},$.fn.easyZoom=function(e){return this.each(function(){var i=$.data(this,"easyZoom");i?void 0===i.isOpen&&i._init():$.data(this,"easyZoom",new t(this,e))})},"function"==typeof define&&define.amd?define(function(){return t}):"undefined"!=typeof module&&module.exports&&(module.exports=t)}(jQuery);